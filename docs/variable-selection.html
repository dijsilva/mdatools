<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Variable selection | Getting started with mdatools for R</title>
  <meta name="description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Variable selection | Getting started with mdatools for R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  <meta name="github-repo" content="svkucheryavski/mdatools.bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Variable selection | Getting started with mdatools for R" />
  
  <meta name="twitter:description" content="This is a user guide for mdatools — R package for preprocessing, exploring and analysis of multivariate data. The package provides methods mostly common for Chemometrics. The general idea of the package is to collect most of the common chemometric methods and give a similar user interface for using them. So if a user knows how to make a model and visualise results for one method, he or she can easily do this for the others." />
  

<meta name="author" content="Sergey Kucheryavskiy" />


<meta name="date" content="2018-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting-methods-1.html">
<link rel="next" href="simca-classification.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="what-is-new.html"><a href="what-is-new.html"><i class="fa fa-check"></i>What is new</a><ul>
<li class="chapter" data-level="" data-path="what-is-new.html"><a href="what-is-new.html#what-expect-from-future-releases"><i class="fa fa-check"></i>What expect from future releases</a></li>
<li class="chapter" data-level="" data-path="what-is-new.html"><a href="what-is-new.html#last-changes-and-improvements-to-book-and-package"><i class="fa fa-check"></i>Last changes and improvements to book and package</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i>Overview</a><ul>
<li class="chapter" data-level="" data-path="what-mdatools-can-do.html"><a href="what-mdatools-can-do.html"><i class="fa fa-check"></i>What mdatools can do?</a></li>
<li class="chapter" data-level="" data-path="how-to-install.html"><a href="how-to-install.html"><i class="fa fa-check"></i>How to install</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="datasets-and-plots.html"><a href="datasets-and-plots.html"><i class="fa fa-check"></i>Datasets and plots</a><ul>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html"><i class="fa fa-check"></i>Attributes and factors</a><ul>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#package-specific-attributes"><i class="fa fa-check"></i>Package specific attributes</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#attributes-for-plots"><i class="fa fa-check"></i>Attributes for plots</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#special-methods-for-data-transformations"><i class="fa fa-check"></i>Special methods for data transformations</a></li>
<li class="chapter" data-level="" data-path="attributes-and-factors.html"><a href="attributes-and-factors.html#data-frames-with-factors"><i class="fa fa-check"></i>Data frames with factors</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html"><i class="fa fa-check"></i>Simple plots</a><ul>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#scatter-plots"><i class="fa fa-check"></i>Scatter plots</a></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#line-plots"><i class="fa fa-check"></i>Line plots</a></li>
<li class="chapter" data-level="" data-path="simple-plots.html"><a href="simple-plots.html#bar-and-errorbar-plots"><i class="fa fa-check"></i>Bar and errorbar plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html"><i class="fa fa-check"></i>Plots for groups of objects</a><ul>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#one-matrix-or-data-frame"><i class="fa fa-check"></i>One matrix or data frame</a></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#list-with-matrices-or-data-frames"><i class="fa fa-check"></i>List with matrices or data frames</a></li>
<li class="chapter" data-level="" data-path="plots-for-groups-of-objects.html"><a href="plots-for-groups-of-objects.html#use-factors-to-split-a-dataset-into-groups"><i class="fa fa-check"></i>Use factors to split a dataset into groups</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="working-with-images.html"><a href="working-with-images.html"><i class="fa fa-check"></i>Working with images</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html"><i class="fa fa-check"></i>Preprocessing</a><ul>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#autoscaling"><i class="fa fa-check"></i>Autoscaling</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#correction-of-spectral-baseline"><i class="fa fa-check"></i>Correction of spectral baseline</a></li>
<li class="chapter" data-level="" data-path="preprocessing.html"><a href="preprocessing.html#smoothing-and-derivatives"><i class="fa fa-check"></i>Smoothing and derivatives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i>Principal component analysis</a><ul>
<li class="chapter" data-level="" data-path="models-and-results.html"><a href="models-and-results.html"><i class="fa fa-check"></i>Models and results</a><ul>
<li class="chapter" data-level="" data-path="models-and-results.html"><a href="models-and-results.html#model-calibration"><i class="fa fa-check"></i>Model calibration</a></li>
<li class="chapter" data-level="" data-path="models-and-results.html"><a href="models-and-results.html#model-validation"><i class="fa fa-check"></i>Model validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html"><i class="fa fa-check"></i>Plotting methods</a><ul>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html#support-for-images"><i class="fa fa-check"></i>Support for images</a></li>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html#manual-x-values-for-loading-line-plot"><i class="fa fa-check"></i>Manual x-values for loading line plot</a></li>
<li class="chapter" data-level="" data-path="plotting-methods.html"><a href="plotting-methods.html#excluding-rows-and-columns"><i class="fa fa-check"></i>Excluding rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="residuals-and-critical-limits.html"><a href="residuals-and-critical-limits.html"><i class="fa fa-check"></i>Residuals and critical limits</a><ul>
<li class="chapter" data-level="" data-path="residuals-and-critical-limits.html"><a href="residuals-and-critical-limits.html#distance-to-model-and-score-distance"><i class="fa fa-check"></i>Distance to model and score distance</a></li>
<li class="chapter" data-level="" data-path="residuals-and-critical-limits.html"><a href="residuals-and-critical-limits.html#critical-limits"><i class="fa fa-check"></i>Critical limits</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="randomized-pca-algorithms.html"><a href="randomized-pca-algorithms.html"><i class="fa fa-check"></i>Randomized PCA algorithms</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="partial-least-squares-regression.html"><a href="partial-least-squares-regression.html"><i class="fa fa-check"></i>Partial least squares regression</a><ul>
<li class="chapter" data-level="" data-path="models-and-results-1.html"><a href="models-and-results-1.html"><i class="fa fa-check"></i>Models and results</a><ul>
<li class="chapter" data-level="" data-path="models-and-results-1.html"><a href="models-and-results-1.html#model-calibration-1"><i class="fa fa-check"></i>Model calibration</a></li>
<li class="chapter" data-level="" data-path="models-and-results-1.html"><a href="models-and-results-1.html#model-validation-1"><i class="fa fa-check"></i>Model validation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="plotting-methods-1.html"><a href="plotting-methods-1.html"><i class="fa fa-check"></i>Plotting methods</a><ul>
<li class="chapter" data-level="" data-path="plotting-methods-1.html"><a href="plotting-methods-1.html#excluding-rows-and-columns-1"><i class="fa fa-check"></i>Excluding rows and columns</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="variable-selection.html"><a href="variable-selection.html"><i class="fa fa-check"></i>Variable selection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="simca-classification.html"><a href="simca-classification.html"><i class="fa fa-check"></i>SIMCA classification</a><ul>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html"><i class="fa fa-check"></i>Calibration and validation</a><ul>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#predictions-and-validation-with-a-test-set"><i class="fa fa-check"></i>Predictions and validation with a test set</a></li>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#class-belonging-probabilities"><i class="fa fa-check"></i>Class belonging probabilities</a></li>
<li class="chapter" data-level="" data-path="calibration-and-validation.html"><a href="calibration-and-validation.html#extreme-plot"><i class="fa fa-check"></i>Extreme plot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multiclass-classification.html"><a href="multiclass-classification.html"><i class="fa fa-check"></i>Multiclass classification</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="pls-discriminant-analysis.html"><a href="pls-discriminant-analysis.html"><i class="fa fa-check"></i>PLS Discriminant Analysis</a><ul>
<li class="chapter" data-level="" data-path="calibration-of-pls-da-model.html"><a href="calibration-of-pls-da-model.html"><i class="fa fa-check"></i>Calibration of PLS-DA model</a></li>
<li class="chapter" data-level="" data-path="classification-plots.html"><a href="classification-plots.html"><i class="fa fa-check"></i>Classification plots</a></li>
<li class="chapter" data-level="" data-path="performance-plots.html"><a href="performance-plots.html"><i class="fa fa-check"></i>Performance plots</a></li>
<li class="chapter" data-level="" data-path="predictions-for-a-new-data.html"><a href="predictions-for-a-new-data.html"><i class="fa fa-check"></i>Predictions for a new data</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Getting started with mdatools for R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="variable-selection" class="section level2 unnumbered">
<h2>Variable selection</h2>
<p>PLS calculates several statistics, which can be used to select most important (or remove least important) variables in order to improve performance and make model simpler. The first two are VIP-scores (variables important for projection) and Selectivity ratio. All details and theory can be found e.g. <a href="http://onlinelibrary.wiley.com/store/10.1002/cem.1360/">here</a>.</p>
<p>Both parameters can be shown as plots and as vector of values for a selected y-variable. Selectivity ration is calculated for all possible components in a model, but VIP scores (due to computational time) only for selected number of components and are recalculated every time you change number of optimal components using <code>selectCompNum()</code> method. Here are some plots.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb155-2" title="2"><span class="kw">plotVIPScores</span>(m1, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">show.labels =</span> T)</a>
<a class="sourceLine" id="cb155-3" title="3"><span class="kw">plotSelectivityRatio</span>(m1, <span class="dt">type =</span> <span class="st">&#39;b&#39;</span>, <span class="dt">show.labels =</span> T)</a>
<a class="sourceLine" id="cb155-4" title="4"><span class="kw">plotSelectivityRatio</span>(m1, <span class="dt">ncomp =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">show.labels =</span> T)</a>
<a class="sourceLine" id="cb155-5" title="5"><span class="kw">plotSelectivityRatio</span>(m1, <span class="dt">ncomp =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">show.labels =</span> T)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="864" /></p>
<p>In the example below, I create two other PLS models by excluding variables with VIP score or selectivity ratio below a threshold (I use 0.5 and 1 correspondingly) and show the performance for both.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">m3 =<span class="st"> </span><span class="kw">pls</span>(X.c, y.c, <span class="dv">5</span>, <span class="dt">scale =</span> T, <span class="dt">cv =</span> <span class="dv">1</span>, <span class="dt">exclcols =</span> <span class="kw">getVIPScores</span>(m1, <span class="dt">ncomp =</span> <span class="dv">2</span>) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb156-2" title="2"><span class="kw">summary</span>(m3)</a></code></pre></div>
<pre><code>## 
## PLS model (class pls) summary
## 
## Performance and validation:
## Number of selected components: 4
##     X cumexpvar Y cumexpvar    R2  RMSE Slope    Bias RPD
## Cal       85.29       98.15 0.981 0.527 0.981  0.0000 7.5
## CV        80.56       96.34 0.963 0.741 0.972 -0.0375 5.3</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1">m4 =<span class="st"> </span><span class="kw">pls</span>(X.c, y.c, <span class="dv">5</span>, <span class="dt">scale =</span> T, <span class="dt">cv =</span> <span class="dv">1</span>, <span class="dt">exclcols =</span> <span class="kw">getSelectivityRatio</span>(m1, <span class="dt">ncomp =</span> <span class="dv">2</span>) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb158-2" title="2"><span class="kw">summary</span>(m4)</a></code></pre></div>
<pre><code>## 
## PLS model (class pls) summary
## 
## Performance and validation:
## Number of selected components: 1
##     X cumexpvar Y cumexpvar    R2  RMSE Slope   Bias RPD
## Cal       86.80       94.97 0.950 0.868 0.950  0e+00 4.6
## CV        84.45       93.92 0.939 0.955 0.944 -3e-04 4.1</code></pre>
<p>Another way is make an inference about regression coefficients and calculate confidence intervals and p-values for each variable. This can be done usine Jack-Knife approach, when model is cross-validated using efficient number of segments (at least ten) and statistics are calculated using the distribution of regression coefficient values obtained for each step. There are two parameters, <code>coeffs.ci</code> and <code>coeffs.alpha</code>, first is to select the method (so far only Jack-Knife is available, the value is <code>'jk'</code>) and second is a level of significance for computing confidence intervals (by default is 0.1). Here is an example.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1">mjk =<span class="st"> </span><span class="kw">pls</span>(X.c, y.c, <span class="dv">7</span>, <span class="dt">scale =</span> T, <span class="dt">coeffs.ci =</span> <span class="st">&#39;jk&#39;</span>, <span class="dt">coeffs.alpha =</span> <span class="fl">0.05</span>)</a></code></pre></div>
<p>If number of segments is not specified as in the example above, full cross-validation will be used.</p>
<p>The statistics are calculated for each y-variable and each available number of components. When you show a plot for regression coefficients, confidence interval will be shown automatically. You can changes this by using parameter <code>show.ci = FALSE</code>.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb161-2" title="2"><span class="kw">plotRegcoeffs</span>(mjk, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">show.labels =</span> T)</a>
<a class="sourceLine" id="cb161-3" title="3"><span class="kw">plotRegcoeffs</span>(mjk, <span class="dt">ncomp =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">show.labels =</span> T)</a>
<a class="sourceLine" id="cb161-4" title="4"><span class="kw">plotRegcoeffs</span>(mjk, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">show.ci =</span> F)</a>
<a class="sourceLine" id="cb161-5" title="5"><span class="kw">plotRegcoeffs</span>(mjk, <span class="dt">ncomp =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&#39;h&#39;</span>, <span class="dt">show.labels =</span> T, <span class="dt">show.ci =</span> F)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-94-1.png" width="864" /></p>
<p>Calling function <code>summary()</code> for regression coefficients allows to get all calculated statistics.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">summary</span>(mjk<span class="op">$</span>coeffs, <span class="dt">ncomp =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## Regression coefficients for Shoesize
## ------------------------------------
##          Estimated coefficients t-value          SE p-value 95% CI (lo)
## Height               0.19357436    23.4 0.008270469   0.000  0.17646559
## Weight               0.18935489    35.1 0.005386414   0.000  0.17821224
## Hairleng            -0.17730737   -17.1 0.010368912   0.000 -0.19875710
## Age                  0.02508113     1.0 0.026525148   0.351 -0.02979032
## Income               0.01291497     0.4 0.033491494   0.702 -0.05636746
## Beer                 0.11441573     6.4 0.017851922   0.000  0.07748621
## Wine                 0.08278735     2.7 0.030960265   0.013  0.01874117
## Sex                 -0.17730737   -17.1 0.010368912   0.000 -0.19875710
## Swim                 0.19426871    14.2 0.013654151   0.000  0.16602295
## Region               0.02673161     1.1 0.023989628   0.275 -0.02289471
## IQ                  -0.01705852    -0.5 0.032399035   0.602 -0.08408103
##          95% CI (up)
## Height    0.21068313
## Weight    0.20049754
## Hairleng -0.15585764
## Age       0.07995258
## Income    0.08219740
## Beer      0.15134524
## Wine      0.14683354
## Sex      -0.15585764
## Swim      0.22251448
## Region    0.07635794
## IQ        0.04996399
## 
## Degrees of freedom: 23, t-value: 2.07</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="kw">summary</span>(mjk<span class="op">$</span>coeffs, <span class="dt">ncomp =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.01</span>)</a></code></pre></div>
<pre><code>## Regression coefficients for Shoesize
## ------------------------------------
##          Estimated coefficients t-value          SE p-value  99% CI (lo)
## Height               0.19357436    23.4 0.008270469   0.000  0.170356376
## Weight               0.18935489    35.1 0.005386414   0.000  0.174233417
## Hairleng            -0.17730737   -17.1 0.010368912   0.000 -0.206416384
## Age                  0.02508113     1.0 0.026525148   0.351 -0.049383866
## Income               0.01291497     0.4 0.033491494   0.702 -0.081106896
## Beer                 0.11441573     6.4 0.017851922   0.000  0.064299387
## Wine                 0.08278735     2.7 0.030960265   0.013 -0.004128502
## Sex                 -0.17730737   -17.1 0.010368912   0.000 -0.206416384
## Swim                 0.19426871    14.2 0.013654151   0.000  0.155936928
## Region               0.02673161     1.1 0.023989628   0.275 -0.040615325
## IQ                  -0.01705852    -0.5 0.032399035   0.602 -0.108013488
##          99% CI (up)
## Height    0.21679234
## Weight    0.20447636
## Hairleng -0.14819835
## Age       0.09954612
## Income    0.10693683
## Beer      0.16453206
## Wine      0.16970321
## Sex      -0.14819835
## Swim      0.23260050
## Region    0.09407855
## IQ        0.07389645
## 
## Degrees of freedom: 23, t-value: 2.81</code></pre>
<p>Function <code>getRegcoeffs()</code> in this case may also return corresponding t-value, standard error, p-value, and confidence interval for each of the coefficient (except intercept) if user specifies a parameter <code>full</code>. The standard error and confidence intervals are also computed for raw, undstandardized, variables (similar to coefficients).</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="kw">show</span>(<span class="kw">getRegcoeffs</span>(mjk, <span class="dt">ncomp =</span> <span class="dv">2</span>, <span class="dt">full =</span> T))</a></code></pre></div>
<pre><code>##           Estimated coefficients     t-value           SE      p-value
## Intercept           1.342626e+01          NA           NA           NA
## Height              7.456695e-02  23.3854388 3.185875e-03 1.559361e-17
## Weight              4.896328e-02  35.1242970 1.392816e-03 1.732554e-21
## Hairleng           -6.865495e-01 -17.0926429 4.014933e-02 1.439599e-14
## Age                 1.081716e-02   0.9524214 1.143995e-02 3.507861e-01
## Income              5.642220e-06   0.3875343 1.463158e-05 7.019238e-01
## Beer                5.010542e-03   6.3971862 7.817789e-04 1.579903e-06
## Wine                7.511377e-03   2.6802915 2.809055e-03 1.336266e-02
## Sex                -6.865495e-01 -17.0926429 4.014933e-02 1.439599e-14
## Swim                1.010496e-01  14.2147650 7.102257e-03 7.018728e-13
## Region              1.035071e-01   1.1174095 9.288992e-02 2.753561e-01
## IQ                 -5.277164e-03  -0.5285419 1.002285e-02 6.021868e-01
##             95% CI (lo)   95% CI (up)
## Intercept            NA            NA
## Height     0.0679764667  8.115743e-02
## Weight     0.0460820210  5.184454e-02
## Hairleng  -0.7696047104 -6.034943e-01
## Age       -0.0128481769  3.448250e-02
## Income    -0.0000246255  3.590994e-05
## Beer       0.0033933089  6.627775e-03
## Wine       0.0017004042  1.332235e-02
## Sex       -0.7696047104 -6.034943e-01
## Swim       0.0863574493  1.157417e-01
## Region    -0.0886503166  2.956646e-01
## IQ        -0.0260110098  1.545668e-02
## attr(,&quot;name&quot;)
## [1] &quot;Regression coefficients for  Shoesize&quot;</code></pre>
<p>It is also possible to change significance level for confidence intervals.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="kw">show</span>(<span class="kw">getRegcoeffs</span>(mjk, <span class="dt">ncomp =</span> <span class="dv">2</span>, <span class="dt">full =</span> T, <span class="dt">alpha =</span> <span class="fl">0.01</span>))</a></code></pre></div>
<pre><code>##           Estimated coefficients     t-value           SE      p-value
## Intercept           1.342626e+01          NA           NA           NA
## Height              7.456695e-02  23.3854388 3.185875e-03 1.559361e-17
## Weight              4.896328e-02  35.1242970 1.392816e-03 1.732554e-21
## Hairleng           -6.865495e-01 -17.0926429 4.014933e-02 1.439599e-14
## Age                 1.081716e-02   0.9524214 1.143995e-02 3.507861e-01
## Income              5.642220e-06   0.3875343 1.463158e-05 7.019238e-01
## Beer                5.010542e-03   6.3971862 7.817789e-04 1.579903e-06
## Wine                7.511377e-03   2.6802915 2.809055e-03 1.336266e-02
## Sex                -6.865495e-01 -17.0926429 4.014933e-02 1.439599e-14
## Swim                1.010496e-01  14.2147650 7.102257e-03 7.018728e-13
## Region              1.035071e-01   1.1174095 9.288992e-02 2.753561e-01
## IQ                 -5.277164e-03  -0.5285419 1.002285e-02 6.021868e-01
##             99% CI (lo)   99% CI (up)
## Intercept            NA            NA
## Height     6.562313e-02  8.351077e-02
## Weight     4.505318e-02  5.287338e-02
## Hairleng  -7.992621e-01 -5.738369e-01
## Age       -2.129862e-02  4.293295e-02
## Income    -3.543353e-05  4.671797e-05
## Beer       2.815826e-03  7.205258e-03
## Wine      -3.745830e-04  1.539734e-02
## Sex       -7.992621e-01 -5.738369e-01
## Swim       8.111117e-02  1.209880e-01
## Region    -1.572661e-01  3.642803e-01
## IQ        -3.341467e-02  2.286034e-02
## attr(,&quot;name&quot;)
## [1] &quot;Regression coefficients for  Shoesize&quot;</code></pre>
<p>The p-values, t-values and standard errors are stored each as a 3-way array similar to regression coefficients. The selection can be made by comparing e.g. p-values with a threshold similar to what we have done with VIP-scores and selectivity ratio.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" title="1">exclcols =<span class="st"> </span>mjk<span class="op">$</span>coeffs<span class="op">$</span>p.values[, <span class="dv">2</span>, <span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb170-2" title="2"><span class="kw">show</span>(exclcols)</a></code></pre></div>
<pre><code>##   Height   Weight Hairleng      Age   Income     Beer     Wine      Sex 
##    FALSE    FALSE    FALSE     TRUE     TRUE    FALSE    FALSE    FALSE 
##     Swim   Region       IQ 
##    FALSE     TRUE     TRUE</code></pre>
<p>Here <code>p.values[, 2, 1]</code> means values for all predictors, model with two components, first y-variable.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1">newm =<span class="st"> </span><span class="kw">pls</span>(X.c, y.c, <span class="dv">3</span>, <span class="dt">scale =</span> T, <span class="dt">cv =</span> <span class="dv">1</span>, <span class="dt">exclcols =</span> exclcols)</a>
<a class="sourceLine" id="cb172-2" title="2"><span class="kw">summary</span>(newm)</a></code></pre></div>
<pre><code>## 
## PLS model (class pls) summary
## 
## Performance and validation:
## Number of selected components: 3
##     X cumexpvar Y cumexpvar    R2  RMSE Slope    Bias RPD
## Cal       97.85       97.79 0.978 0.575 0.978  0.0000 6.9
## CV        96.65       96.49 0.965 0.727 0.972 -0.0161 5.4</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1"><span class="kw">show</span>(<span class="kw">getRegcoeffs</span>(newm))</a></code></pre></div>
<pre><code>##               Shoesize
## Intercept  4.952691046
## Height     0.091079963
## Weight     0.052708955
## Hairleng  -0.315927643
## Age        0.000000000
## Income     0.000000000
## Beer       0.009320427
## Wine       0.018524717
## Sex       -0.315927643
## Swim       0.134354170
## Region     0.000000000
## IQ         0.000000000
## attr(,&quot;exclrows&quot;)
##    Age Income Region     IQ 
##      4      5     10     11 
## attr(,&quot;name&quot;)
## [1] &quot;Regression coefficients for  Shoesize&quot;</code></pre>
<p>As you can see, the variables <em>Age</em>, <em>Income</em>, <em>Region</em> and <em>IQ</em> have been excluded as they are not related to the <em>Shoesize</em>, which seems to be correct.</p>
<p>Variable selection as well as all described above can be also carried out for PLS discriminant analysis (PLS-DA), which can be explained later in one of the next chapters.</p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="plotting-methods-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simca-classification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
